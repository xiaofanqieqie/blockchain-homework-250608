# 🎮 使用指南

## 🚀 快速开始

### 启动交互式工具
```bash
cd contracts
npx hardhat run scripts/interactive-test.js --network private
```

## 📋 功能菜单

启动后会看到完整的功能菜单：
```
==================================================
🎯 众筹合约交互式测试工具
==================================================
1.  📝 创建新项目
2.  💰 向项目投资
3.  💸 提取项目资金
4.  🔄 申请退款
5.  ❌ 取消项目
6.  📋 查看项目详情
7.  👥 查看项目投资者
8.  🔍 查看用户投资记录
9.  📊 查看用户创建的项目
10. 📈 查看用户参与的项目
11. 📉 查看平台统计信息
12. ⚙️  管理员功能
13. 💳 查看账户信息
0.  🚪 退出程序
==================================================
```

## 🎯 完整测试流程

### 步骤1: 查看账户信息
```
选择: 13
查看当前账户地址和余额
```

### 步骤2: 创建项目
```
选择: 1
项目标题: 智能手表众筹
项目描述: 一款具有健康监测功能的智能手表
目标金额: 0.01 (ETH)
持续时间: 3600 (秒，即1小时)
确认创建: y
```

### 步骤3: 查看项目详情
```
选择: 6
项目ID: 1
查看项目的详细信息和进度
```

### 步骤4: 投资项目
```
选择: 2
项目ID: 1
投资金额: 0.005 (ETH)
确认投资: y
```

### 步骤5: 再次投资达到目标
```
选择: 2
项目ID: 1
投资金额: 0.006 (ETH)
确认投资: y
项目状态变为"成功"
```

### 步骤6: 提取资金
```
选择: 3
项目ID: 1
确认提取: y
查看扣除2.5%手续费后的实际金额
```

## 💡 功能详解

### 📝 项目管理
- **创建项目**: 支持小数金额和秒级时间
- **取消项目**: 项目创建者可主动取消
- **查看详情**: 显示完整项目信息

### 💰 投资功能
- **最小投资**: 0.0001 ETH
- **投资限制**: 项目必须处于活跃状态
- **实时更新**: 投资后立即更新项目进度

### 💸 资金管理
- **提取条件**: 项目成功且未提取过
- **手续费**: 自动扣除2.5%平台手续费
- **退款机制**: 项目失败时全额退款

### 📊 查询功能
- **项目统计**: 查看平台整体数据
- **用户记录**: 查看个人投资和创建记录
- **实时状态**: 显示最新的项目状态

## 🎯 测试场景

### 场景1: 成功众筹
```
1. 创建项目 (目标: 0.01 ETH, 时长: 1小时)
2. 投资 0.006 ETH
3. 再投资 0.005 ETH (达到目标)
4. 提取资金 (收到 0.01075 ETH，扣除手续费)
```

### 场景2: 失败退款
```
1. 创建项目 (目标: 0.02 ETH, 时长: 1小时)
2. 投资 0.005 ETH
3. 取消项目或等待超时
4. 申请退款 (全额退回 0.005 ETH)
```

### 场景3: 小额众筹
```
1. 创建项目 (目标: 0.001 ETH, 时长: 30分钟)
2. 投资 0.0002 ETH
3. 投资 0.0003 ETH  
4. 投资 0.0006 ETH (达到目标)
5. 提取资金
```

## 💡 使用技巧

### 输入格式
- **金额**: 使用小数，如 `0.001` 表示 0.001 ETH
- **时间**: 使用秒数，如 `3600` 表示1小时
- **确认**: 输入 `y` 确认，其他任何输入取消

### 快捷操作
- **查看所有项目**: 项目ID留空
- **查看当前账户**: 地址留空
- **快速退出**: 按 `Ctrl+C` 或选择 `0`

### 常用时间换算
```
1小时 = 3600秒
1天 = 86400秒
1周 = 604800秒
1个月 = 2592000秒 (30天)
```

## 🔧 脚本命令

### 基本命令
```bash
# 编译合约
npx hardhat compile

# 运行测试
npx hardhat test

# 部署合约
npx hardhat run scripts/deploy.js --network private

# 交互式测试
npx hardhat run scripts/interactive-test.js --network private

# 生成钱包
npx hardhat run scripts/generate-wallets.js
```

### 控制台操作
```bash
# 启动控制台
npx hardhat console --network private

# 连接合约
const address = "0x74785B0A9EE496968d01F5B924BA3B9AF9C99b42";
const Crowdfunding = await ethers.getContractFactory("Crowdfunding");
const crowdfunding = Crowdfunding.attach(address);

# 查询项目
const project = await crowdfunding.getProject(1);
console.log(project);

# 创建项目
await crowdfunding.createProject(
  "测试项目",
  "项目描述", 
  ethers.parseEther("0.01"),
  3600
);
```

## 🚨 注意事项

### 网络要求
- 确保私有网络正常运行
- 账户有足够ETH支付gas费用
- 网络延迟可能影响交易确认

### 安全提醒
- 私钥安全保管，不要泄露
- 测试环境使用，不要用于生产
- 每次交易都需要等待区块确认

### 故障排除
- **连接失败**: 检查网络配置
- **交易失败**: 检查账户余额和参数
- **合约错误**: 查看错误消息了解原因

## 📞 获取帮助

遇到问题时：
1. 查看控制台错误信息
2. 检查 `deployment-info.json` 文件
3. 运行 `npm test` 验证合约状态
4. 使用 `npx hardhat console` 手动调试
