# 🎯 众筹合约交互式测试工具使用指南

## 📝 简介
这是一个功能完整的交互式命令行工具，让你能够通过友好的中文菜单来测试已部署的众筹智能合约的所有功能。

## 🚀 快速开始

### 1. 启动交互式测试工具
```bash
# 在 contracts/ 目录下运行
npx hardhat run scripts/interactive-test.js --network localhost
```

### 2. 工具界面
启动后你会看到这样的菜单：
```
==================================================
🎯 众筹合约交互式测试工具
==================================================
1.  📝 创建新项目
2.  💰 向项目投资
3.  💸 提取项目资金
4.  🔄 申请退款
5.  ❌ 取消项目
6.  📋 查看项目详情
7.  👥 查看项目投资者
8.  🔍 查看用户投资记录
9.  📊 查看用户创建的项目
10. 📈 查看用户参与的项目
11. 📉 查看平台统计信息
12. ⚙️  管理员功能
13. 💳 查看账户信息
0.  🚪 退出程序
==================================================
请选择功能 (0-13):
```

## 🎮 完整测试流程示例

### 步骤 1: 查看账户信息
- 选择 `13`
- 查看当前账户地址和余额

### 步骤 2: 创建第一个项目
- 选择 `1`
- 输入项目信息：
  ```
  项目标题: 智能手表众筹
  项目描述: 一款具有健康监测功能的智能手表
  目标金额: 1.5
  众筹天数: 30
  ```
- 确认创建 (输入 `y`)
- 记住创建的项目ID (例如: 1)

### 步骤 3: 查看项目详情
- 选择 `6`
- 输入项目ID: `1`
- 查看项目的详细信息

### 步骤 4: 向项目投资
- 选择 `2`
- 输入项目ID: `1`
- 输入投资金额: `0.8`
- 确认投资 (输入 `y`)

### 步骤 5: 查看更新后的项目状态
- 选择 `6`
- 输入项目ID: `1`
- 查看投资后的项目进度

### 步骤 6: 再次投资使项目成功
- 选择 `2`
- 输入项目ID: `1`
- 输入投资金额: `0.8`
- 确认投资 (输入 `y`)
- 项目应该达到目标并显示为"成功"状态

### 步骤 7: 提取项目资金 (仅项目创建者)
- 选择 `3`
- 输入项目ID: `1`
- 确认提取 (输入 `y`)
- 查看扣除2.5%手续费后的实际收到金额

### 步骤 8: 查看投资者列表
- 选择 `7`
- 输入项目ID: `1`
- 查看该项目的所有投资者和投资金额

### 步骤 9: 查看平台统计
- 选择 `11`
- 查看平台整体统计信息

## 🔧 功能详解

### 📝 项目管理功能
- **创建项目**: 设置标题、描述、目标金额、持续时间
- **取消项目**: 项目创建者可以主动取消进行中的项目
- **查看详情**: 显示项目完整信息和进度

### 💰 投资功能
- **投资项目**: 向任何活跃项目投资以太币
- **查看投资**: 查看个人投资记录和统计
- **投资限制**: 最小投资0.01 ETH，创建者不能投资自己的项目

### 💸 资金管理
- **提取资金**: 项目成功后创建者可提取资金
- **平台手续费**: 自动扣除2.5%手续费
- **申请退款**: 项目失败时投资者可申请全额退款

### 📊 查询功能
- **项目概览**: 查看所有项目列表
- **用户统计**: 查看用户创建和参与的项目
- **平台数据**: 查看成功率、资金统计等

### ⚙️ 管理员功能 (仅合约所有者)
- **更新手续费**: 调整平台手续费率 (0-10%)
- **更新钱包**: 修改平台收费钱包地址
- **紧急处理**: 紧急标记问题项目为失败

## 🎯 测试场景建议

### 场景1: 成功众筹
1. 创建项目 (目标: 1 ETH)
2. 投资达到目标
3. 提取资金
4. 查看资金分配

### 场景2: 失败退款
1. 创建项目 (目标: 2 ETH)
2. 少量投资 (0.5 ETH)
3. 取消项目或等待截止
4. 申请退款

### 场景3: 多项目管理
1. 创建多个项目
2. 查看项目列表
3. 分别投资不同项目
4. 查看个人投资统计

### 场景4: 管理员操作
1. 使用合约所有者账户
2. 调整平台手续费
3. 紧急处理问题项目

## 💡 使用技巧

### 输入说明
- **金额输入**: 使用小数形式，如 `1.5` 表示 1.5 ETH
- **地址输入**: 可以输入完整的以太坊地址
- **确认操作**: 输入 `y` 确认，其他任何输入都会取消
- **留空选项**: 某些字段可以留空使用默认值

### 常见操作
- **查看所有项目**: 在项目详情中留空项目ID
- **查看当前账户**: 在用户查询中留空地址
- **快速导航**: 使用数字0-13快速选择功能
- **安全退出**: 使用 `Ctrl+C` 或选择 `0` 退出

### 注意事项
- 确保区块链网络正常运行
- 保证账户有足够的ETH支付gas费用
- 每次交易都需要等待区块确认
- 管理员功能需要使用合约所有者账户

## 🐛 故障排除

### 连接问题
```bash
# 检查网络连接
curl -X POST -H "Content-Type: application/json" \
  --data '{"jsonrpc":"2.0","method":"net_version","params":[],"id":1}' \
  http://152.53.165.85:8545
```

### 合约地址问题
- 确保 `deployment-info.json` 文件存在
- 检查合约地址是否正确

### 交易失败
- 检查账户余额是否足够
- 确认输入参数是否有效
- 查看错误消息了解具体原因

## 🎉 快速体验命令

```bash
# 完整测试流程（一条命令）
cd contracts && npx hardhat run scripts/interactive-test.js --network localhost
```

启动后按照菜单提示操作即可！🚀 